CREATE TABLE Member (
    member_Id number(4) primary key,
    name varchar2(40) not null,
    address VARCHAR2(100),
    hp CHAR(13) UNIQUE,
    join_date date not null
);

CREATE TABLE Book(
    book_Id NUMBER(5) PRIMARY KEY,
    title VARCHAR2(50) NOT NULL,
    author VARCHAR2(40) NOT NULL,
    publisher VARCHAR2(40) NOT NULL,
    available CHAR(1),
    reg_date DATE NOT NULL
);

CREATE TABLE Loan (
    loan_Id NUMBER GENERATED BY DEFAULT AS IDENTITY primary key,
    member_Id NUMBER(4) NOT NULL,
    book_Id NUMBER(5) NOT NULL,
    loan_date DATE,
    return_date DATE,
    actual_date DATE
);

INSERT INTO Member VALUES ('1001', '김유신', '서울특별시 강남구 역삼동', '010-1234-1001', '2024-01-10 09:15:00');
INSERT INTO Member VALUES ('1002', '김춘추', '대전광역시 유성구 장대동', '010-1234-1002', '2024-02-14 14:30:45');
INSERT INTO Member VALUES ('1003', '장보고', '대구광역시 수성구 반월동', '010-1234-1003', '2024-03-01 11:05:20');
INSERT INTO Member VALUES ('1004', '강감찬', '부산광역시 금정구 부곡동', '010-1234-1004', '2024-03-22 16:40:00');
INSERT INTO Member VALUES ('1005', '이순신', '광주광역시 광산구 우산동', '010-1234-1005', '2024-04-10 08:50:10');

INSERT INTO Book VALUES ('10001', '태백산맥', '조정래', '문학수첩', 'Y', '2014-01-10 09:15:00');
INSERT INTO Book VALUES ('10002', '데미안', '헤르만 헤세', '민음사', 'N', '2014-02-14 14:30:45');
INSERT INTO Book VALUES ('10003', '토지', '박경리', '문학사상사', 'Y', '2014-03-01 11:05:20');
INSERT INTO Book VALUES ('10004', '명품 자바 프로그래밍', '제임스 고슬링', '한빛출판사', 'Y', '2014-03-22 16:40:00');
INSERT INTO Book VALUES ('10005', '로미오와 줄리엣', '세익스피어', '열린책들', 'N', '2014-04-10 08:50:10');
INSERT INTO Book VALUES ('10006', '삼국지', '나관중', '민음사', 'Y', '2014-04-05 09:12:02');
INSERT INTO Book VALUES ('10007', '칼의 노래', '김훈', '문학동네', 'Y', '2014-06-10 12:53:17');
INSERT INTO Book VALUES ('10008', '데이터베이스', '래리 엘리슨', '한빛출판사', 'N', '2014-05-23 10:13:09');
INSERT INTO Book VALUES ('10009', 'Linux 운영체제', '리누스 토발즈', '한빛출판사', 'Y', '2014-03-11 11:23:43');
INSERT INTO Book VALUES ('10010', '어린 왕자', '생텍쥐베리', '열린책들', 'Y', '2014-05-13 15:27:21');

INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1001', '10002', '2024-03-01 10:02:31', '2024-03-15 10:02:31', '2024-03-13 09:44:19');
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1002', '10004', '2024-03-05 15:10:02', '2024-03-19 15:10:02', '2024-03-12 17:12:30');
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1003', '10008', '2024-04-01 11:01:12', '2024-04-15 11:01:12', NULL);
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1002', '10001', '2024-04-10 14:32:01', '2024-04-24 14:32:01', '2024-04-22 13:56:32');
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1005', '10004', '2024-04-15 16:24:21', '2024-04-29 16:24:21', NULL);
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1004', '10006', '2024-05-01 09:12:09', '2024-05-15 09:12:09', '2024-05-14 09:21:27');
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1001', '10007', '2024-05-03 13:51:07', '2024-05-17 13:51:07', '2024-05-16 14:05:10');
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1003', '10009', '2024-06-01 11:15:43', '2024-06-15 11:15:43', NULL);
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1004', '10004', '2024-06-02 12:30:52', '2024-06-16 12:30:52', NULL);
INSERT INTO Loan(member_id, book_id, loan_date, return_date, actual_date) VALUES ('1002', '10008', '2024-06-05 10:06:17', '2024-06-19 10:06:17', NULL);

-- 실습 4.
SELECT member_id, name, hp, address from member;

-- 실습 5.
SELECT title, author from book;

-- 실습 6.
SELECT name, address from member where address like '부산%%';

-- 실습 7.
SELECT title from book where available= 'Y';

-- 실습 8.
SELECT * from book where book_id = '10005';

-- 실습 9.
SELECT member_id, name, hp from member 
    where member_id = 1002;

-- 실습 10.
SELECT title from book where reg_date like '2014-03-%%';

-- 실습 11.
SELECT title, author, publisher from book where publisher = '민음사';

-- 실습 12.
SELECT loan_id, member_id, book_id from loan 
    where actual_date is null;

-- 실습 13.
SELECT * from member where name like '김%%';

-- 실습 14.
SELECT name, address from member 
    where address like '부산광역시%' 
    or address like '대구광역시%';

-- 실습 15.
SELECT book_id, title from book 
    where book_id = 10003
    or book_id = 10006;
    
-- 실습 16.
SELECT title, author from book
    where author = '조정래'
    or author = '박경리';
    
-- 실습 17.
SELECT name, join_date from member
    where join_date < '2024-04-01';
    
-- 실습 18.
SELECT loan_id, member_id, book_id, loan_date from loan
    where loan_date >= '2024-05-01';
    
-- 실습 19.
SELECT title, author, publisher from book
    where available = 'N';
    
-- 실습 20.
SELECT * from book where title like '%자바%';

-- 실습 21.
select name, hp from member where hp != '010-1234-1003';

-- 실습 22.
SELECT loan_id, member_id, book_id from loan
    where return_date < '2024-03-20';
    
-- 실습 23.
SELECT * from member order by name asc;

-- 실습 24.
SELECT title, reg_date from book order by reg_date desc;

-- 실습 25.
SELECT title from book 
    order by title asc
    FETCH first 3 rows only;
    
-- 실습 26.
SELECT * from member
    order by join_date desc
    fetch first 1 row only;
    
-- 실습 27.
SELECT loan_id, loan_date from loan
    ORDER by loan_date asc
    fetch first 2 rows only;
    
-- 실습 28.
SELECT count(*) from member;

-- 실습 29.
SELECT count(*) from book;

-- 실습 30.
select count(case when available = 'Y' then 1 end) as "COUNT(*)" from book;

-------------------------------------------------------

-- 실습 31.
SELECT
    publisher,
    count(*) AS 출판_도서수 
FROM book 
GROUP BY publisher;

-- 실습 32.
SELECT COUNT(*) FROM loan WHERE loan_date LIKE '2024-%%-%%';

-- 실습 33.
SELECT 
    member_id,
    COUNT(*) AS 대출_도서수
FROM loan
GROUP BY member_id;

-- 실습 34. 
SELECT 
    book_id,
    COUNT(*) AS 대출횟수
FROM loan
GROUP BY book_id;
    
-- 실습 35.
SELECT 
    member_id,
    COUNT(*) AS 회원_대출건수
FROM loan
GROUP BY member_id
HAVING COUNT(*) >= 2;
    
-- 실습 36.
SELECT 
    book_id,
    COUNT(*) AS 도서_대출건수
FROM loan
GROUP BY book_id
HAVING COUNT(*) >= 2;
    
-- 실습 37.
SELECT 
    MEMBER_ID,
    NAME,
    BOOK_ID,
    TITLE,
    LOAN_DATE
FROM member M
JOIN book B, M.member_id = B.member_id
JOIN loan L, B.book_id = L.book_id;

-- 실습 38.

-- 실습 39.

-- 실습 40.

-- 실습 41.

-- 실습 42.

-- 실습 43.

-- 실습 44.

-- 실습 45.

-- 실습 46.

-- 실습 47.

-- 실습 48.

-- 실습 49.

-- 실습 50.

